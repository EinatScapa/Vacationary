(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{205:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),s=n(38),r=n.n(s),o=(n(92),n(4)),i=n.n(o),l=n(9),u=n(6),d=n(8),j=n(5),b=(n(97),n(2)),p=function(){return Object(b.jsxs)("div",{className:"top",children:[Object(b.jsx)("h1",{className:"title",children:"VACATIONARY"}),Object(b.jsx)("p",{className:"subTitle",children:"Premium vacations"}),Object(b.jsx)("p",{className:"subTitle",children:"Everywhere around the world"})]})},h=n(80),f=n(81),O=n(83),m=n(82),x=n(55),g=n.n(x),v=function(e){var t=e.record,n=e.status,a=Object(j.g)(),c=Object(u.c)((function(e){return e.user})),s=localStorage.getItem("token"),r=g()(t.from_date).format("MMM Do YY"),o=g()(t.to_date).format("MMM Do YY"),p="".concat(r," - ").concat(o),x=function(){var e=Object(l.a)(i.a.mark((function e(){var n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,e.prev=1,e.next=4,fetch("/api/vacations",{method:"delete",body:JSON.stringify({id:n}),headers:{"content-type":"application/json",authorization:s}});case 4:200===(c=e.sent).status&&(alert("Vacation deleted"),window.location.reload()),401===c.status&&(alert("You are offline or unauthorized. Please login again"),a.push("/login")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(l.a)(i.a.mark((function e(){var r,o,l,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.id,o=t.id,"isFollowed"!==n){e.next=17;break}return e.prev=3,e.next=6,fetch("/api/follow",{method:"delete",body:JSON.stringify({u_id:r,v_id:o}),headers:{"content-type":"application/json",authorization:s}});case 6:201===(l=e.sent).status&&(alert("Removed from followed vacations"),a.push("/"),window.location.reload()),401===l.status&&(alert("You are offline or unauthorized. Please login again"),a.push("/login")),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),console.log(e.t0),alert("Something's wrong! pleas try again");case 15:e.next=30;break;case 17:if("isUnfollowed"!==n){e.next=30;break}return e.prev=18,e.next=21,fetch("/api/follow",{method:"post",body:JSON.stringify({u_id:r,v_id:o}),headers:{"content-type":"application/json",authorization:s}});case 21:201===(u=e.sent).status&&(alert("Added to followed vacations"),a.push("/"),window.location.reload()),401===u.status&&(alert("You are offline or unauthorized. Please login again"),a.push("/login")),e.next=30;break;case 26:e.prev=26,e.t1=e.catch(18),console.log(e.t1),alert("Something's wrong! pleas try again");case 30:case"end":return e.stop()}}),e,null,[[3,11],[18,26]])})));return function(){return e.apply(this,arguments)}}();return Object(b.jsxs)("div",{className:"item",children:[Object(b.jsxs)("h3",{className:"itemDestination",children:[" ",t.destination," "]}),Object(b.jsxs)("p",{className:"itemDate",children:[" ",p," "]}),Object(b.jsx)("img",{className:"itemImg",src:t.img,alt:"destinationIMG"}),Object(b.jsxs)("p",{className:"itemFollowers",children:[" Followed by ",t.followers," users "]}),Object(b.jsxs)("div",{className:"itemFooter",children:[Object(b.jsxs)("p",{className:"itemPrice",children:[" $ ",t.price," "]}),"user"===(null===c||void 0===c?void 0:c.role)?Object(b.jsx)("button",{className:"followBtn",onClick:function(){return v()},children:"isFollowed"===n?Object(b.jsx)(h.a,{}):Object(b.jsx)(f.a,{})}):Object(b.jsxs)("div",{className:"itemBtns",children:[Object(b.jsxs)(d.b,{className:"editBtn",to:"/edit/".concat(t.id),children:[" ",Object(b.jsx)(m.a,{})," "]}),Object(b.jsxs)("button",{className:"delBtn",onClick:function(){return x()},children:[" ",Object(b.jsx)(O.a,{})," "]})]})]})]})},w=function(){var e=Object(u.c)((function(e){return e.user})),t=Object(u.c)((function(e){return e.vacations})),n=Object(u.c)((function(e){return e.followedVacationsId})),a=t.filter((function(e){return n.some((function(t){return t===e.id}))})),c=t.filter((function(e){return-1===n.indexOf(e.id)}));return"user"===(null===e||void 0===e?void 0:e.role)?Object(b.jsxs)("div",{className:"main",children:[Object(b.jsx)("span",{className:"headline",children:" My Favorite Vacations "}),Object(b.jsx)("div",{className:"list",children:a.map((function(e){return Object(b.jsx)(v,{record:e,status:"isFollowed"},e.id)}))}),Object(b.jsx)("span",{className:"headline",children:" Other Vacations "}),Object(b.jsx)("div",{className:"list",children:c.map((function(e){return Object(b.jsx)(v,{record:e,status:"isUnfollowed"},e.id)}))})]}):"admin"===(null===e||void 0===e?void 0:e.role)?Object(b.jsxs)("div",{className:"main",children:[Object(b.jsxs)("div",{className:"adminBtns",children:[Object(b.jsx)(d.b,{className:"chartBtn",to:"/chart",children:" Watch Charts "}),Object(b.jsx)(d.b,{className:"addBtn",to:"/add",children:" Add New Vacation "})]}),Object(b.jsx)("div",{className:"list",children:t.map((function(e){return Object(b.jsx)(v,{record:e},e.id)}))})]}):Object(b.jsxs)("div",{className:"guest",children:[Object(b.jsx)("h2",{children:" Hello guest! "}),Object(b.jsx)("h3",{children:" Please connect to see our vacations "})]})},y=function(){return Object(b.jsxs)("div",{className:"home",children:[Object(b.jsx)(p,{}),Object(b.jsx)(w,{})]})},N=n(40),k=function(){var e=Object(j.g)(),t=Object(u.b)(),n=function(){var n=Object(l.a)(i.a.mark((function n(a){var c,s,r,o,l;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a.preventDefault(),c=a.target[0].value,s=a.target[1].value,n.prev=3,n.next=6,fetch("/api/users/login",{method:"post",body:JSON.stringify({username:c,password:s}),headers:{"content-type":"application/json"}});case 6:return r=n.sent,n.next=9,r.json();case 9:o=n.sent,200===r.status?(localStorage.setItem("token",o.token),l=Object(N.a)(o.token),t({type:"login",payload:l}),alert("User Logged-in Succesfuly"),e.push("/home"),window.location.reload()):400===r.status?alert("Missing some info"):401===r.status?alert("User not found"):402===r.status&&alert("Wrong password"),n.next=17;break;case 13:n.prev=13,n.t0=n.catch(3),console.log(n.t0),alert("Something's wrong! pleas try again");case 17:case"end":return n.stop()}}),n,null,[[3,13]])})));return function(e){return n.apply(this,arguments)}}();return Object(b.jsxs)("div",{className:"login",children:[Object(b.jsx)("h2",{className:"loginTitle",children:"Login to your account"}),Object(b.jsxs)("form",{onSubmit:n,children:[Object(b.jsxs)("label",{className:"input",children:["Username:",Object(b.jsx)("input",{type:"text",name:"username"})]}),Object(b.jsxs)("label",{className:"input",children:["Password:",Object(b.jsx)("input",{type:"text",name:"password"})]}),Object(b.jsx)("input",{className:"submit",type:"submit",value:"Login"})]}),Object(b.jsx)("h5",{children:"Don't have an acount yet?"}),Object(b.jsx)(d.b,{className:"linkRegister",to:"/Register",children:"Register Here!"})]})},S=function(){var e=Object(j.g)(),t=function(){var t=Object(l.a)(i.a.mark((function t(n){var a,c,s,r,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.target[0].value,c=n.target[1].value,s=n.target[2].value,r=n.target[3].value,n.preventDefault(),t.prev=5,t.next=8,fetch("/api/users/register",{method:"post",body:JSON.stringify({Fname:a,Lname:c,username:s,password:r}),headers:{"content-type":"application/json"}});case 8:201===(o=t.sent).status?(alert("User Registered Succesfuly"),e.push("/login")):400===o.status?alert("Missing some info"):401===o.status&&alert("Username already exists"),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(5),console.log(t.t0),alert("Something's wrong! pleas try again");case 16:case"end":return t.stop()}}),t,null,[[5,12]])})));return function(e){return t.apply(this,arguments)}}();return Object(b.jsxs)("div",{className:"register",children:[Object(b.jsx)("h2",{className:"registerTitle",children:"Create new acount"}),Object(b.jsxs)("form",{onSubmit:t,children:[Object(b.jsxs)("label",{className:"input",children:["First Name:",Object(b.jsx)("input",{type:"text",name:"Fname"})]}),Object(b.jsxs)("label",{className:"input",children:["Last Name:",Object(b.jsx)("input",{type:"text",name:"Lname"})]}),Object(b.jsxs)("label",{className:"input",children:["Choose Username:",Object(b.jsx)("input",{type:"text",name:"username"})]}),Object(b.jsxs)("label",{className:"input",children:["Choose Password:",Object(b.jsx)("input",{type:"text",name:"password"})]}),Object(b.jsx)("input",{className:"submit",type:"submit",value:"Create"})]})]})},C=n(11),V=function(){var e=Object(j.g)(),t=localStorage.getItem("token"),n=Object(a.useState)(""),c=Object(C.a)(n,2),s=c[0],r=c[1],o=Object(a.useState)(""),u=Object(C.a)(o,2),d=u[0],p=u[1],h=Object(a.useState)(""),f=Object(C.a)(h,2),O=f[0],m=f[1],x=Object(a.useState)(""),g=Object(C.a)(x,2),v=g[0],w=g[1],y=Object(a.useState)(0),N=Object(C.a)(y,2),k=N[0],S=N[1],V=function(){var n=Object(l.a)(i.a.mark((function n(a,c,s,r,o){var l;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("/api/vacations",{method:"post",body:JSON.stringify({destination:a,img:c,from_date:s,to_date:r,price:o}),headers:{"content-type":"application/json",authorization:t}});case 3:201===(l=n.sent).status&&(alert("Vacation Added"),e.push("/home"),window.location.reload()),401===l.status&&(alert("You are offline or unauthorized. Please login again"),e.push("/login")),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e,t,a,c,s){return n.apply(this,arguments)}}();return Object(b.jsxs)("div",{className:"add",children:[Object(b.jsx)("h3",{className:"pageTitle",children:" Add New Vacation "}),Object(b.jsx)("input",{type:"text",placeholder:"Destination",onChange:function(e){return r(e.target.value||"unknown value")}}),Object(b.jsx)("input",{type:"text",placeholder:"img URL",onChange:function(e){return p(e.target.value||"unknown value")}}),Object(b.jsx)("input",{type:"text",placeholder:"from_date",onChange:function(e){return m(e.target.value||"unknown value")}}),Object(b.jsx)("input",{type:"text",placeholder:"to_date",onChange:function(e){return w(e.target.value||"unknown value")}}),Object(b.jsx)("input",{type:"text",placeholder:"price",onChange:function(e){return S(e.target.value||"unknown value")}}),Object(b.jsx)("button",{className:"addSmallBtn",onClick:function(){return V(s,d,O,v,k)},children:" Add vacation "})]})},I=function(){var e=Object(j.g)(),t=localStorage.getItem("token"),n=Object(j.h)().id,c=Object(u.c)((function(e){return e.vacations})).find((function(e){return e.id==n})),s=c.destination,r=c.img,o=c.from_date,d=c.to_date,p=c.price,h=Object(a.useState)(s),f=Object(C.a)(h,2),O=f[0],m=f[1],x=Object(a.useState)(r),g=Object(C.a)(x,2),v=g[0],w=g[1],y=Object(a.useState)(o),N=Object(C.a)(y,2),k=N[0],S=N[1],V=Object(a.useState)(d),I=Object(C.a)(V,2),_=I[0],F=I[1],L=Object(a.useState)(p),z=Object(C.a)(L,2),A=z[0],B=z[1],Y=function(){var a=Object(l.a)(i.a.mark((function a(){var c;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,fetch("/api/vacations",{method:"put",body:JSON.stringify({id:n,destination:O,img:v,from_date:k,to_date:_,price:A}),headers:{"content-type":"application/json",authorization:t}});case 3:201===(c=a.sent).status&&(alert("Changes Saved"),e.push("/home"),window.location.reload()),401===c.status&&(alert("You are offline or unauthorized. Please login again"),e.push("/login")),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.log(a.t0);case 11:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(){return a.apply(this,arguments)}}();return Object(b.jsxs)("div",{className:"edit",children:[Object(b.jsx)("h3",{className:"pageTitle",children:" edit Vacation "}),Object(b.jsx)("input",{type:"text",defaultValue:"".concat(s),onChange:function(e){return m(e.target.value)}}),Object(b.jsx)("input",{type:"text",defaultValue:"".concat(r),URL:!0,onChange:function(e){return w(e.target.value)}}),Object(b.jsx)("input",{type:"text",defaultValue:"".concat(o),onChange:function(e){return S(e.target.value)}}),Object(b.jsx)("input",{type:"text",defaultValue:"".concat(d),onChange:function(e){return F(e.target.value)}}),Object(b.jsx)("input",{type:"text",defaultValue:"".concat(p),onChange:function(e){return B(e.target.value)}}),Object(b.jsx)("button",{className:"addSmallBtn",onClick:function(){return Y()},children:" Save "}),Object(b.jsx)("button",{className:"addSmallBtn",onClick:function(){return e.push("/home")},children:" Discard changes "})]})},_=n(86);function F(){var e=Object(u.c)((function(e){return e.vacations})),t={labels:e.filter((function(e){return e.followers>0})).map((function(e){return e.id})),datasets:[{label:"num of followers",data:e.filter((function(e){return e.followers>0})).map((function(e){return e.followers})),backgroundColor:"rgba(207, 105, 99, 0.2)",borderColor:"rgba(207, 105, 99, 1)",borderWidth:.5}]};return Object(b.jsxs)("div",{className:"bar",children:[Object(b.jsx)("h1",{className:"pageTitle",children:"Followers Status"}),Object(b.jsx)("h4",{children:"Number of users following"}),Object(b.jsx)(_.a,{data:t,options:{}})]})}var L=function(){var e=Object(u.b)(),t=Object(j.g)(),n=Object(u.c)((function(e){return e.user})),a=n?n.Fname:"Guest";return Object(b.jsxs)("div",{className:"header",children:[Object(b.jsx)("div",{className:"logo",children:Object(b.jsx)("h3",{children:"VACATIONARY"})}),Object(b.jsxs)("div",{className:"nav",children:[Object(b.jsx)("p",{children:" Contact "}),Object(b.jsx)(d.b,{to:"/",children:" Home "}),Object(b.jsx)("p",{children:" About "})]}),Object(b.jsxs)("div",{className:"info",children:[Object(b.jsxs)("p",{className:"hello",children:["Hello ",a]}),n?Object(b.jsx)("button",{className:"logoutBtn",onClick:function(){return e({type:"logout"}),localStorage.clear(),alert("User Logged-out Succesfuly"),void t.push("/home")},children:" Log-Out "}):Object(b.jsx)(d.b,{to:"/login",children:" Log-In "})]})]})};function z(){var e=Object(u.b)(),t=localStorage.getItem("token"),n=t?Object(N.a)(t):null,c=function(){var t=Object(l.a)(i.a.mark((function t(){var n,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("/api/vacations");case 3:return n=t.sent,t.next=6,n.json();case 6:a=t.sent,e({type:"getVacations",payload:a}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),s=function(){var a=Object(l.a)(i.a.mark((function a(){var c,s,r,o,l,u;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return c=n.id,a.prev=1,a.next=4,fetch("/api/vacations/followed",{method:"post",body:JSON.stringify({id:c}),headers:{"content-type":"application/json",authorization:t}});case 4:if(200!==(s=a.sent).status){a.next=12;break}return a.next=8,s.json();case 8:for(r=a.sent,o=[],l=0;l<r.length;l++)u=r[l].v_id,o.push(u);e({type:"getFollowedVacations",payload:o});case 12:401===s.status&&alert("You are offline or unauthorized. Please login again"),a.next=18;break;case 15:a.prev=15,a.t0=a.catch(1),console.log(a.t0);case 18:case"end":return a.stop()}}),a,null,[[1,15]])})));return function(){return a.apply(this,arguments)}}();return Object(a.useEffect)((function(){Object(l.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e({type:"login",payload:n});case 3:return t.next=5,c();case 5:"user"===(null===n||void 0===n?void 0:n.role)&&s(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),alert("something went wrong");case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}),[]),Object(b.jsx)("div",{className:"app",children:Object(b.jsxs)(d.a,{children:[Object(b.jsx)(L,{}),Object(b.jsxs)(j.d,{children:[Object(b.jsx)(j.b,{exact:!0,path:"/home",component:y}),Object(b.jsx)(j.b,{exact:!0,path:"/login",component:k}),Object(b.jsx)(j.b,{exact:!0,path:"/register",component:S}),Object(b.jsx)(j.b,{exact:!0,path:"/add",component:V}),Object(b.jsx)(j.b,{exact:!0,path:"/edit/:id",component:I}),Object(b.jsx)(j.b,{exact:!0,path:"/chart",component:F}),Object(b.jsx)(j.a,{exact:!0,from:"/",to:"/home"})]})]})})}var A=n(87),B=n(12),Y={user:null,btn:"Log-In",vacations:[],followedVacationsId:[]};var M=Object(A.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"login":return Object(B.a)(Object(B.a)({},e),{},{user:t.payload,btn:"Log-Out"});case"logout":return Object(B.a)(Object(B.a)({},e),{},{user:null,btn:"Log-In"});case"getVacations":return Object(B.a)(Object(B.a)({},e),{},{vacations:t.payload});case"getFollowedVacations":return Object(B.a)(Object(B.a)({},e),{},{followedVacationsId:t.payload});default:return e}}));r.a.render(Object(b.jsxs)(c.a.StrictMode,{children:[Object(b.jsx)(u.a,{store:M,children:Object(b.jsx)(z,{})}),","]}),document.getElementById("root"))},92:function(e,t,n){},97:function(e,t,n){}},[[205,1,2]]]);
//# sourceMappingURL=main.56318c99.chunk.js.map